# download from WIS-JMA
* * * * * cd /home/noyori/tests; ./download_pub.sh p1 >> log/download_pub.sh.p1.log 2>&1
* * * * * cd /home/noyori/tests; ./download.sh p2 >> log/download.sh.p2.log 2>&1
* * * * * cd /home/noyori/tests; ./download.sh p2_crex >> log/download.sh.p2_crex.log 2>&1
* * * * * cd /home/noyori/tests; ./download.sh p3 >> log/download.sh.p3.log 2>&1
* * * * * cd /home/noyori/tests; ./download.sh p4 >> log/download.sh.p4.log 2>&1
* * * * * cd /home/noyori/tests; ./download.sh p5 >> log/download.sh.p4.log 2>&1

# publish to ap
* * * * * cd /home/noyori/tests; for i in `ls -1 download_p2/cached/*|grep -v '\.tmp$'|uniq`;do ./pub.sh --cron --rm_list_file cache_p2/open ap_p2 ${i} wasabi japan.meteorological.agency.open.data p2  8;done >> log/pub.sh.ap_p2.log 2>&1
* * * * * cd /home/noyori/tests; for i in `ls -1 download_p2_crex/cached/*|grep -v '\.tmp$'|uniq`;do ./pub.sh --cron --rm_list_file cache_p2_crex/open ap_p2_crex ${i} wasabi japan.meteorological.agency.open.data p2  2;done >> log/pub.sh.ap_p2_crex.log 2>&1
* * * * * cd /home/noyori/tests; for i in `ls -1 download_p3/cached/*|grep -v '\.tmp$'|uniq`;do ./pub.sh --cron --rm_list_file cache_p3/open ap_p3 ${i} wasabi japan.meteorological.agency.open.data p3 16;done >> log/pub.sh.ap_p3.log 2>&1
* * * * * cd /home/noyori/tests; for i in `ls -1 download_p4/cached/*|grep -v '\.tmp$'|uniq`;do ./pub.sh --cron --rm_list_file cache_p4/open ap_p4 ${i} wasabi japan.meteorological.agency.open.data p4 32;done >> log/pub.sh.ap_p4.log 2>&1
* * * * * cd /home/noyori/tests; for i in `ls -1 download_p5/cached/*|grep -v '\.tmp$'|uniq`;do ./pub.sh --cron --rm_list_file --pub_dir_list_index cache_p5/open ap_p5 ${i} wasabi japan.meteorological.agency.open.data p5 32;done >> log/pub.sh.ap_p5.log 2>&1

# clone from ap to us
* * * * * cd /home/noyori/tests; ./clone.sh --urgent --cron cache ap_to_us_p1 wasabi japan.meteorological.agency.open.data wasabi_us japan.meteorological.agency.open.data.us.east.1 p1  4 >> log/clone.sh.ap_to_us_p1.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache ap_to_us_p2 wasabi japan.meteorological.agency.open.data wasabi_us japan.meteorological.agency.open.data.us.east.1 p2  8 >> log/clone.sh.ap_to_us_p2.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache ap_to_us_p3 wasabi japan.meteorological.agency.open.data wasabi_us japan.meteorological.agency.open.data.us.east.1 p3 16 >> log/clone.sh.ap_to_us_p3.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache ap_to_us_p4 wasabi japan.meteorological.agency.open.data wasabi_us japan.meteorological.agency.open.data.us.east.1 p4 32 >> log/clone.sh.ap_to_us_p4.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron --pub_dir_list_index cache ap_to_us_p5 wasabi japan.meteorological.agency.open.data wasabi_us japan.meteorological.agency.open.data.us.east.1 p5 16 >> log/clone.sh.ap_to_us_p5.log 2>&1

# clone from us to eu
* * * * * cd /home/noyori/tests; ./clone.sh --urgent --cron cache us_to_eu_p1 wasabi_us japan.meteorological.agency.open.data.us.east.1 wasabi_eu japan.meteorological.agency.open.data.eu.central.1 p1  4 >> log/clone.sh.us_to_eu_p1.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache us_to_eu_p2 wasabi_us japan.meteorological.agency.open.data.us.east.1 wasabi_eu japan.meteorological.agency.open.data.eu.central.1 p2  8 >> log/clone.sh.us_to_eu_p2.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache us_to_eu_p3 wasabi_us japan.meteorological.agency.open.data.us.east.1 wasabi_eu japan.meteorological.agency.open.data.eu.central.1 p3 16 >> log/clone.sh.us_to_eu_p3.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron cache us_to_eu_p4 wasabi_us japan.meteorological.agency.open.data.us.east.1 wasabi_eu japan.meteorological.agency.open.data.eu.central.1 p4 32 >> log/clone.sh.us_to_eu_p4.log 2>&1
* * * * * cd /home/noyori/tests; ./clone.sh --cron --pub_dir_list_index cache us_to_eu_p5 wasabi_us japan.meteorological.agency.open.data.us.east.1 wasabi_eu japan.meteorological.agency.open.data.eu.central.1 p5 32 >> log/clone.sh.us_to_eu_p5.log 2>&1

# delete on object storage
0   0 * * * cd /home/noyori/tests; ./del.sh        cache ap       wasabi    japan.meteorological.agency.open.data                      24 32 >> log/del.sh.ap.log 2>&1
10  * * * * cd /home/noyori/tests; ./del.sh --cron cache ap_index wasabi    japan.meteorological.agency.open.data/4PubSub              24 8 >> log/del.sh.ap_index.log 2>&1
20  8 * * * cd /home/noyori/tests; ./del.sh        cache us       wasabi_us japan.meteorological.agency.open.data.us.east.1            24 32 >> log/del.sh.us.log 2>&1
30  * * * * cd /home/noyori/tests; ./del.sh --cron cache us_index wasabi_us japan.meteorological.agency.open.data.us.east.1/4PubSub    24 8 >> log/del.sh.us_index.log 2>&1
40 16 * * * cd /home/noyori/tests; ./del.sh        cache eu       wasabi_eu japan.meteorological.agency.open.data.eu.central.1         24 32 >> log/del.sh.eu.log 2>&1
50  * * * * cd /home/noyori/tests; ./del.sh --cron cache eu_index wasabi_eu japan.meteorological.agency.open.data.eu.central.1/4PubSub 24 8 >> log/del.sh.eu_index.log 2>&1

# delete on local PC
55 1,9,17 * * * find /home/noyori/tests/cache_p* -mindepth 6 -type d -mmin +360 | grep 20 | xargs -n1 -I{} sh -c "rm -rf {} && sleep 10" > /dev/null 2>&1
55 6,14,22 * * * find /home/noyori/tests/cache -mindepth 5 -type d -mmin +360 | grep 20 | xargs -n1 -I{} sh -c "rm -rf {} && sleep 10" > /dev/null 2>&1

# subscribe from eu
* * * * * cd /home/noyori/tests; now=`date -u --iso-8601=seconds | tr -d '\-T:' | sed -e 's|+.*||g'`; ./sub.sh --cron cache sub_bufr_synop wasabi_eu japan.meteorological.agency.open.data p3 16 bufr_pattern.txt 1> sub_bufr_synop/${now}.tmp 2>>log/sub.sh.bufr_synop.log; if test -s sub_bufr_synop/${now}.tmp; then mv -f sub_bufr_synop/${now}.tmp sub_bufr_synop/${now}.txt; else rm -f sub_bufr_synop/${now}.tmp; fi

# convert bufr synop to arrow
* * * * * cd /home/noyori/tests; ./bufr_to_arrow.sh >> log/bufr_to_arrow.sh.log 2>&1

# convert arrow to tile arrow
* * * * * cd /home/noyori/tests; ./arrow_to_tile_arrow.sh >> log/arrow_to_tile_arrow.sh.log 2>&1

# publish tile arrow
*/10 * * * * cd /home/noyori/tests; ./pub_tile_arrow.sh >> log/pub_tile_arrow.sh.log 2>&1
